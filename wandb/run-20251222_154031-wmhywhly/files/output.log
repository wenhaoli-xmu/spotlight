/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:11<00:00,  3.84s/it]
RANK-0 training started !
/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/torch/distributed/distributed_c10d.py:4807: UserWarning: No device id is provided via `init_process_group` or `barrier `. Using the current device set by the user.
  warnings.warn(  # warn only once
Loading checkpoint shards: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 3/3 [00:05<00:00,  1.72s/it]
  0%|                                                                                                                                           | 0/16 [00:00<?, ?it/s]/pfs/rl-train/wenhaoli/spotlight/train.py:409: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.detach().clone() or sourceTensor.detach().clone().requires_grad_(True), rather than torch.tensor(sourceTensor).
  length = torch.tensor(length, dtype=torch.int64, device=local_rank)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [01:15<00:00,  4.73s/it]
✅
Traceback (most recent call last):
  File "/pfs/rl-train/wenhaoli/spotlight/train.py", line 621, in <module>
  File "/pfs/rl-train/wenhaoli/spotlight/train.py", line 509, in train
    history_oacc.append(oth_acc)

  File "/pfs/rl-train/wenhaoli/spotlight/train.py", line 180, in compute_attn_supervise_loss
    return top_acc.item(), oth_fp.item(), scaled_thresh.mean().item(), loss
    ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/debugpy/public_api.py", line 47, in wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/debugpy/server/api.py", line 312, in __call__
    pydevd._wait_for_attach(cancel=cancel_event)
  File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/debugpy/_vendored/pydevd/pydevd.py", line 2917, in _wait_for_attach
    py_db.block_until_configuration_done(cancel=cancel)
  File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/debugpy/_vendored/pydevd/pydevd.py", line 945, in block_until_configuration_done
    self._py_db_command_thread_event.wait(TIMEOUT_FAST)
  File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/threading.py", line 634, in wait
    signaled = self._cond.wait(timeout)
               ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/threading.py", line 338, in wait
    gotit = waiter.acquire(True, timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
[rank0]: Traceback (most recent call last):
[rank0]:   File "/pfs/rl-train/wenhaoli/spotlight/train.py", line 621, in <module>
[rank0]:   File "/pfs/rl-train/wenhaoli/spotlight/train.py", line 509, in train
[rank0]:     history_oacc.append(oth_acc)
[rank0]:
[rank0]:   File "/pfs/rl-train/wenhaoli/spotlight/train.py", line 180, in compute_attn_supervise_loss
[rank0]:     return top_acc.item(), oth_fp.item(), scaled_thresh.mean().item(), loss
[rank0]:     ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/debugpy/public_api.py", line 47, in wrapper
[rank0]:     return wrapped(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/debugpy/server/api.py", line 312, in __call__
[rank0]:     pydevd._wait_for_attach(cancel=cancel_event)
[rank0]:   File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/debugpy/_vendored/pydevd/pydevd.py", line 2917, in _wait_for_attach
[rank0]:     py_db.block_until_configuration_done(cancel=cancel)
[rank0]:   File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/site-packages/debugpy/_vendored/pydevd/pydevd.py", line 945, in block_until_configuration_done
[rank0]:     self._py_db_command_thread_event.wait(TIMEOUT_FAST)
[rank0]:   File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/threading.py", line 634, in wait
[rank0]:     signaled = self._cond.wait(timeout)
[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/pfs/rl-train/wenhaoli/miniconda3/envs/mirorl-v2-copy/lib/python3.12/threading.py", line 338, in wait
[rank0]:     gotit = waiter.acquire(True, timeout)
[rank0]:             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: KeyboardInterrupt
